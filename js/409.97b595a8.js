"use strict";(self["webpackChunka_virtual_table"]=self["webpackChunka_virtual_table"]||[]).push([[409],{66409:function(t,e,i){i.r(e),i.d(e,{default:function(){return d}});var s=function(){var t=this,e=t._self._c;return e("div",[e("a-virtual-table",{attrs:{columns:t.columns,"data-source":t.list,itemSize:54,dynamic:!1,keyProp:"id","row-key":"id",scroll:{x:1300,y:600}},scopedSlots:t._u([{key:"name",fn:function({text:i}){return e("a",{},[t._v(t._s(i)+"===")])}}])})],1)},n=[],l=i(79879),o=i(30076),r={components:{AVirtualTable:o.Z},data(){return{columns:[{title:"Name",dataIndex:"name",key:"name",scopedSlots:{customRender:"name"},width:200},{title:"id",dataIndex:"id",key:"id",width:100},{title:"text",dataIndex:"text",key:"text",ellipsis:!0,width:400},{title:"Address",dataIndex:"address",key:"address 1",ellipsis:!0,width:400},{title:"Long Column Long Column Long Column",dataIndex:"address",key:"address 2",ellipsis:!0,width:300},{title:"Long Column Long Column",dataIndex:"address",key:"address 3",ellipsis:!0,width:300},{title:"Long Column",dataIndex:"address",key:"address 4",ellipsis:!0}],list:(0,l.c)(0,2e3)}},methods:{}},a=r,c=i(1001),h=(0,c.Z)(a,s,n,!1,null,"6e8ffad6",null),d=h.exports},30076:function(t,e,i){i.d(e,{Z:function(){return S}});var s=function(){var t=this,e=t._self._c;return e("div",[e("a-table",t._g(t._b({attrs:{pagination:!1,columns:t.tableColumns,"data-source":t.renderData},scopedSlots:t._u([t._l(Object.keys(t.$scopedSlots),(function(e){return{key:e,fn:function(i){return[t._t(e,null,null,"object"===typeof i?i:{text:i})]}}}))],null,!0)},"a-table",t.$attrs,!1),t.$listeners)),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isHideAppend,expression:"!isHideAppend"}],ref:"append",staticClass:"ant-table-append"},[t._t("append")],2)],1)},n=[],l=(i(21703),i(10936)),o=i.n(l);function r(t){const e=window.getComputedStyle(t,null),i=["auto","scroll"];return i.includes(e.overflow)||i.includes(e["overflow-y"])}function a(t){let e=t;while(e){if([window,document,document.documentElement].includes(e))return window;if(r(e))return e;e=e.parentNode}return e||window}function c(t){return t===window?window.pageYOffset:t.scrollTop}function h(t){return t===window?window.innerHeight:t.offsetHeight}function d(t,e){t===window?window.scroll(0,e):t.scrollTop=e}const u=[".ant-table-scroll .ant-table-body",".ant-table-fixed-left .ant-table-body-inner",".ant-table-fixed-right .ant-table-body-inner"];var p={inheritAttrs:!1,name:"a-virtual-table",props:{dataSource:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},keyProp:{type:String,default:"id"},itemSize:{type:Number,default:60},scrollBox:{type:String},buffer:{type:Number,default:100},throttleTime:{type:Number,default:10},dynamic:{type:Boolean,default:!0},virtualized:{type:Boolean,default:!0},isTree:{type:Boolean,default:!1}},data(){return{start:0,end:void 0,sizes:{},renderData:[],isCheckedAll:!1,isCheckedImn:!1,isHideAppend:!1}},computed:{tableColumns(){const t=this.$createElement;return this.columns.map((e=>"selection"===e.type?{title:()=>t("a-checkbox",{attrs:{checked:this.isCheckedAll,indeterminate:this.isCheckedImn},on:{change:()=>this.onCheckAllRows(!this.isCheckedAll)}}),customRender:(e,i)=>t("a-checkbox",{attrs:{checked:i.$v_checked},on:{change:()=>this.onCheckRow(i,!i.$v_checked)}}),width:60,...e}:e.index?{customRender:(t,i,s)=>{const n=this.start+s;return"function"===typeof e.index?e.index(n):n+1},...e}:e))},offsetMap({keyProp:t,itemSize:e,sizes:i,dataSource:s}){if(!this.dynamic)return{};const n={};let l=0;for(let o=0;o<s.length;o++){const r=s[o][t];n[r]=l;const a=i[r],c="number"===typeof a?a:e;l+=c}return n}},methods:{initData(){this.isInnerScroll=!1,this.scroller=this.getScroller(),this.toTop=this.$el.getBoundingClientRect().top-this.scroller.getBoundingClientRect().top,this.handleScroll(),this.$nextTick((()=>{this.handleScroll()})),this.onScroll=o()(this.handleScroll,this.throttleTime),this.scroller.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.onScroll)},getScroller(){let t;if(this.scrollBox){if(t=document.querySelector(this.scrollBox),!t)throw new Error(` scrollBox prop: '${this.scrollBox}' is not a valid selector`);return r(t)||console.warn(`Warning! scrollBox prop: '${this.scrollBox}' is not a scroll element`),t}return this.$attrs.scroll&&this.$attrs.scroll.y?(this.isInnerScroll=!0,this.$el.querySelector(".ant-table-body")):a(this.$el)},handleScroll(){this.virtualized&&(this.updateSizes(),this.calcRenderData(),this.calcPosition())},updateSizes(){if(!this.dynamic)return;let t=[];t=this.isTree?this.$el.querySelectorAll(".ant-table-body .ant-table-row-level-0"):this.$el.querySelectorAll(".ant-table-body .ant-table-tbody .ant-table-row"),Array.from(t).forEach(((t,e)=>{const i=this.renderData[e];if(!i)return;let s=t.offsetHeight;const n=t.nextSibling;if(n&&n.classList&&n.classList.contains("ant-table-expanded-row")&&(s+=t.nextSibling.offsetHeight),this.isTree){let e=t.nextSibling;while(e&&"TR"===e.tagName&&!e.classList.contains("ant-table-row-level-0"))s+=e.offsetHeight,e=e.nextSibling}const l=i[this.keyProp];this.sizes[l]!==s&&(this.$set(this.sizes,l,s),t._offsetHeight=s)}))},calcRenderData(){const{scroller:t,buffer:e,dataSource:i}=this,s=c(t)-e-this.toTop,n=this.isInnerScroll?this.$attrs.scroll.y:h(t),l=c(t)+n+e-this.toTop;let o,r;if(this.dynamic){let t=0,e=i.length-1,n=0;while(t<=e){n=Math.floor((t+e)/2);const i=this.getItemOffsetTop(n);if(i<s){const e=this.getItemOffsetTop(n+1);if(e>s)break;t=n+1}else e=n-1}o=n,r=i.length-1;for(let s=o+1;s<i.length;s++){const t=this.getItemOffsetTop(s);if(t>=l){r=s;break}}}else o=s<=0?0:Math.floor(s/this.itemSize),r=l<=0?0:Math.ceil(l/this.itemSize);o%2&&(o-=1),this.top=s,this.bottom=l,this.start=o,this.end=r,this.renderData=i.slice(o,r+1),this.$emit("change",this.renderData,this.start,this.end)},calcPosition(){const t=this.dataSource.length-1,e=this.getItemOffsetTop(t)+this.getItemSize(t),i=this.getItemOffsetTop(this.start);u.forEach((t=>{const s=this.$el.querySelector(t);if(s){if(!s.wrapEl){const t=document.createElement("div"),e=document.createElement("div");t.style.display="inline-block",e.style.display="inline-block",t.appendChild(e),e.appendChild(s.children[0]),s.insertBefore(t,s.firstChild),s.wrapEl=t,s.innerEl=e}s.wrapEl&&(s.wrapEl.style.height=e+"px",s.innerEl.style.transform=`translateY(${i}px)`)}}))},getItemOffsetTop(t){if(!this.dynamic)return this.itemSize*t;const e=this.dataSource[t];return e&&this.offsetMap[e[this.keyProp]]||0},getItemSize(t){if(t<=-1)return 0;const e=this.dataSource[t];if(e){const t=e[this.keyProp];return this.sizes[t]||this.itemSize}return this.itemSize},update(){this.toTop=this.$el.getBoundingClientRect().top-this.scroller.getBoundingClientRect().top,this.handleScroll()},scrollTo(t,e=!1){const i=this.dataSource[t];i&&this.scroller&&(this.updateSizes(),this.calcRenderData(),this.$nextTick((()=>{const i=this.getItemOffsetTop(t);d(this.scroller,i),e||setTimeout((()=>{this.scrollTo(t,!0)}),50)})))},renderAllData(){this.renderData=this.dataSource,this.$emit("change",this.dataSource,0,this.dataSource.length-1),this.$nextTick((()=>{u.forEach((t=>{const e=this.$el.querySelector(t);e&&e.wrapEl&&(e.wrapEl.style.height="auto",e.innerEl.style.transform="translateY(0px)")}))}))},doUpdate(){this.hasDoUpdate||this.scroller&&(this.isHideAppend=!0,this.update(),this.hasDoUpdate=!0,this.$nextTick((()=>{this.hasDoUpdate=!1,this.isHideAppend=!1})))},clearSelection(){this.dataSource.forEach((t=>this.$set(t,"$v_checked",!1))),this.isCheckedAll=!1,this.isCheckedImn=!1,this.emitSelectionChange()},toggleRowSelection(t,e){const i="boolean"===typeof e?e:!t.$v_checked;this.onCheckRow(t,i)},emitSelectionChange(){const t=this.dataSource.filter((t=>t.$v_checked));this.$emit("selection-change",t)},onCheckAllRows(t){t=!!this.isCheckedImn||t,this.dataSource.forEach((e=>this.$set(e,"$v_checked",t))),this.isCheckedAll=t,this.isCheckedImn=!1,this.emitSelectionChange()},onCheckRow(t,e){this.$set(t,"$v_checked",e);const i=this.dataSource.filter((t=>!0===t.$v_checked)).length;0===i?(this.isCheckedAll=!1,this.isCheckedImn=!1):i===this.dataSource.length?(this.isCheckedAll=!0,this.isCheckedImn=!1):(this.isCheckedAll=!1,this.isCheckedImn=!0),this.emitSelectionChange()}},watch:{dataSource(){this.virtualized?this.doUpdate():this.renderAllData()},virtualized:{immediate:!0,handler(t){t?this.doUpdate():this.renderAllData()}}},created(){this.$nextTick((()=>{this.initData()}))},mounted(){const t=this.$refs.append;this.$el.querySelector(".ant-table-body").appendChild(t)},beforeDestroy(){this.scroller&&(this.scroller.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onScroll))}},f=p,m=i(1001),y=(0,m.Z)(f,s,n,!1,null,null,null),S=y.exports},79879:function(t,e,i){function s(t,e){const i=[];for(let s=t;s<e;s++){const e=l(),o=l();i.push({id:t++,index:s,text:e,text2:o,show:!1,checked:!1,date:(new Date).toLocaleString(),name:"王小虎",province:"上海",city:"普陀区",address:"上海市普陀区金沙江路 1518 弄",zip:200333,category:"江浙小吃、小吃零食",desc:"荷兰优质淡奶，奶香浓而不腻",shop:"王小虎夫妻店",shopId:"10333",count:n(0,1e3)})}return i}function n(t,e){return Math.floor(Math.random()*(e-t))+t}function l(){const t=["这是一条测试数据","君不见黄河之水天上来，奔流到海不复回。","十年生死两茫茫","寻寻觅觅，冷冷清清，凄凄惨惨戚戚。","桃花坞里桃花庵，桃花庵里桃花仙；桃花仙人种桃树，又摘桃花卖酒钱。","明月几时有，把酒问青天。","槛菊愁烟兰泣露，罗幕轻寒，","寒蝉凄切，对长亭晚，骤雨初歇。都门帐饮无绪，留恋处，兰舟催发。执手相看泪眼，竟无语凝噎。念去去，千里烟波，暮霭沉沉楚天阔。多情自古伤离别，更那堪冷落清秋节！今宵酒醒何处？杨柳岸，晓风残月。此去经年，应是良辰好景虚设。便纵有千种风情，更与何人说？","红豆生南国，春来发几枝。","黄鹂"],e=Math.floor(10*Math.random());return t[e]}i.d(e,{c:function(){return s}})}}]);
//# sourceMappingURL=409.97b595a8.js.map