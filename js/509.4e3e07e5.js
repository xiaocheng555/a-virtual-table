"use strict";(self["webpackChunkel_table_virtual_scroll"]=self["webpackChunkel_table_virtual_scroll"]||[]).push([[509],{48998:function(e,t,i){i.d(t,{Z:function(){return p}});var n=function(){var e=this,t=e._self._c;return t("a-table",e._g(e._b({attrs:{columns:e.tableColumns,"data-source":e.renderData},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots),(function(t){return{key:t,fn:function(i){return[e._t(t,null,null,"object"===typeof i?i:{text:i})]}}}))],null,!0)},"a-table",e.$attrs,!1),e.$listeners))},s=[],l=(i(21703),i(10936)),o=i.n(l);function r(e){const t=window.getComputedStyle(e,null),i=["auto","scroll"];return i.includes(t.overflow)||i.includes(t["overflow-y"])}function c(e){let t=e;while(t){if([window,document,document.documentElement].includes(t))return window;if(r(t))return t;t=t.parentNode}return t||window}function a(e){return e===window?window.pageYOffset:e.scrollTop}function h(e){return e===window?window.innerHeight:e.offsetHeight}var d={inheritAttrs:!1,name:"a-virtual-table",props:{dataSource:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},keyProp:{type:String,default:"id"},itemSize:{type:Number,default:60},buffer:{type:Number,default:50},throttleTime:{type:Number,default:10},dynamic:{type:Boolean,default:!0}},data(){return{sizes:{},renderData:[],isCheckedAll:!1,isCheckedImn:!1}},computed:{tableColumns(){const e=this.$createElement;return this.columns.map((t=>"selection"===t.type?{title:()=>e("a-checkbox",{attrs:{checked:this.isCheckedAll,indeterminate:this.isCheckedImn},on:{change:()=>this.onCheckAllRows(!this.isCheckedAll)}}),customRender:(t,i)=>e("a-checkbox",{attrs:{checked:i.$v_checked},on:{change:()=>this.onCheckRow(i,!i.$v_checked)}}),width:60,...t}:t.index?{customRender:(e,i,n)=>{const s=this.start+n;return"function"===typeof t.index?t.index(s):s+1},...t}:t))},offsetMap({keyProp:e,itemSize:t,sizes:i,dataSource:n}){if(!this.dynamic)return{};const s={};let l=0;for(let o=0;o<n.length;o++){const r=n[o][e];s[r]=l;const c=i[r],a="number"===typeof c?c:t;l+=a}return s}},methods:{initData(){this.scroller=this.getScroller(),this.handleScroll(),this.$nextTick((()=>{this.handleScroll()})),this.onScroll=o()(this.handleScroll,this.throttleTime),this.scroller.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.onScroll)},getScroller(){let e;if(this.scrollBox){if(e=document.querySelector(this.scrollBox),!e)throw new Error(` scrollBox prop: '${this.scrollBox}' is not a valid selector`);return r(e)||console.warn(`Warning! scrollBox prop: '${this.scrollBox}' is not a scroll element`),e}return this.$attrs.scroll&&this.$attrs.scroll.y?this.$el.querySelector(".ant-table-body"):c(this.$el)},handleScroll(){this.updateSizes(),this.calcRenderData(),this.calcPosition()},updateSizes(){if(!this.dynamic)return;const e=this.$el.querySelectorAll(".ant-table-body .ant-table-tbody .ant-table-row");Array.from(e).forEach(((e,t)=>{const i=this.renderData[t];if(!i)return;let n=e.offsetHeight;const s=i[this.keyProp];this.sizes[s]!==n&&this.$set(this.sizes,s,n)}))},calcRenderData(){const{scroller:e,buffer:t,dataSource:i}=this,n=a(e)-t,s=a(e)+h(e)+t;let l,o;if(this.dynamic){let e=0,t=i.length-1,r=0;while(e<=t){r=Math.floor((e+t)/2);const i=this.getItemOffsetTop(r);if(i<n){const t=this.getItemOffsetTop(r+1);if(t>n)break;e=r+1}else t=r-1}l=r,o=i.length-1;for(let n=l+1;n<i.length;n++){const e=this.getItemOffsetTop(n);if(e>=s){o=n;break}}}else l=n<=0?0:Math.floor(n/this.itemSize),o=s<=0?0:Math.ceil(s/this.itemSize);l%2&&(l-=1),this.top=n,this.bottom=s,this.start=l,this.end=o,this.renderData=i.slice(l,o+1),this.$emit("change",this.renderData,this.start,this.end)},calcPosition(){const e=this.dataSource.length-1,t=this.getItemOffsetTop(e)+this.getItemSize(e),i=this.getItemOffsetTop(this.start),n=[".ant-table-scroll .ant-table-body",".ant-table-fixed-left .ant-table-body-inner",".ant-table-fixed-right .ant-table-body-inner"];n.forEach((e=>{const n=this.$el.querySelector(e);if(n){if(!n.wrapEl){const e=document.createElement("div"),t=document.createElement("div");e.style.display="inline-block",t.style.display="inline-block",e.appendChild(t),t.appendChild(n.children[0]),n.insertBefore(e,n.firstChild),n.wrapEl=e,n.innerEl=t}n.wrapEl&&(n.wrapEl.style.height=t+"px",n.innerEl.style.transform=`translateY(${i}px)`)}}))},getItemOffsetTop(e){if(!this.dynamic)return this.itemSize*e;const t=this.dataSource[e];return t&&this.offsetMap[t[this.keyProp]]||0},getItemSize(e){if(e<=-1)return 0;const t=this.dataSource[e];if(t){const e=t[this.keyProp];return this.sizes[e]||this.itemSize}return this.itemSize},update(){this.handleScroll()},clearSelection(){this.dataSource.forEach((e=>this.$set(e,"$v_checked",!1))),this.isCheckedAll=!1,this.isCheckedImn=!1,this.emitSelectionChange()},toggleRowSelection(e,t){const i="boolean"===typeof t?t:!e.$v_checked;this.onCheckRow(e,i)},emitSelectionChange(){const e=this.dataSource.filter((e=>e.$v_checked));this.$emit("selection-change",e)},onCheckAllRows(e){e=!!this.isCheckedImn||e,this.dataSource.forEach((t=>this.$set(t,"$v_checked",e))),this.isCheckedAll=e,this.isCheckedImn=!1,this.emitSelectionChange()},onCheckRow(e,t){this.$set(e,"$v_checked",t);const i=this.dataSource.filter((e=>!0===e.$v_checked)).length;0===i?(this.isCheckedAll=!1,this.isCheckedImn=!1):i===this.dataSource.length?(this.isCheckedAll=!0,this.isCheckedImn=!1):(this.isCheckedAll=!1,this.isCheckedImn=!0),this.emitSelectionChange()}},created(){this.$nextTick((()=>{this.initData()}))},beforeDestroy(){this.scroller&&(this.scroller.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onScroll))}},u=d,f=i(1001),m=(0,f.Z)(u,n,s,!1,null,"de25045e",null),p=m.exports},33509:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var n=function(){var e=this,t=e._self._c;return t("div",[t("a-virtual-table",{ref:"virtualTable",attrs:{columns:e.columns,"data-source":e.list,itemSize:54,keyProp:"id","row-key":"id",pagination:!1,scroll:{x:1300,y:600}},on:{"selection-change":e.handleSelectionChange},scopedSlots:e._u([{key:"name",fn:function({text:i}){return t("a",{},[e._v(e._s(i)+"=12==")])}}])}),t("div",{staticStyle:{"margin-top":"20px"}},[t("a-button",{on:{click:function(t){return e.toggleSelection([e.list[1],e.list[2]])}}},[e._v("切换第二、第三行的选中状态")]),t("a-button",{on:{click:function(t){return e.toggleSelection()}}},[e._v("取消选择")])],1)],1)},s=[],l=i(79879),o=i(48998),r={components:{AVirtualTable:o.Z},data(){return{columns:[{type:"selection"},{title:"id",dataIndex:"id",key:"id",width:100},{title:"text",dataIndex:"text",key:"text",width:400},{title:"Address",dataIndex:"address",key:"address 1",ellipsis:!0,width:400},{title:"Long Column Long Column Long Column",dataIndex:"address",key:"address 2",ellipsis:!0,width:300},{title:"Long Column Long Column",dataIndex:"address",key:"address 3",ellipsis:!0,width:300},{title:"Long Column",dataIndex:"address",key:"address 4",ellipsis:!0,width:300,fixed:"right"}],list:(0,l.c)(0,2e3),multipleSelection:[]}},methods:{toggleSelection(e){e?e.forEach((e=>{this.$refs.virtualTable.toggleRowSelection(e)})):this.$refs.virtualTable.clearSelection()},handleSelectionChange(e){console.log("multipleSelection",e),this.multipleSelection=e}}},c=r,a=i(1001),h=(0,a.Z)(c,n,s,!1,null,"6d8367a4",null),d=h.exports},79879:function(e,t,i){function n(e,t){const i=[];for(let n=0;n<t;n++){const t=l(),o=l();i.push({id:e++,index:n,text:t,text2:o,show:!1,checked:!1,date:(new Date).toLocaleString(),name:"王小虎",province:"上海",city:"普陀区",address:"上海市普陀区金沙江路 1518 弄",zip:200333,category:"江浙小吃、小吃零食",desc:"荷兰优质淡奶，奶香浓而不腻",shop:"王小虎夫妻店",shopId:"10333",count:s(0,1e3)})}return i}function s(e,t){return Math.floor(Math.random()*(t-e))+e}function l(){const e=["这是一条测试数据","君不见黄河之水天上来，奔流到海不复回。","十年生死两茫茫","寻寻觅觅，冷冷清清，凄凄惨惨戚戚。","桃花坞里桃花庵，桃花庵里桃花仙；桃花仙人种桃树，又摘桃花卖酒钱。","明月几时有，把酒问青天。","槛菊愁烟兰泣露，罗幕轻寒，","寒蝉凄切，对长亭晚，骤雨初歇。都门帐饮无绪，留恋处，兰舟催发。执手相看泪眼，竟无语凝噎。念去去，千里烟波，暮霭沉沉楚天阔。多情自古伤离别，更那堪冷落清秋节！今宵酒醒何处？杨柳岸，晓风残月。此去经年，应是良辰好景虚设。便纵有千种风情，更与何人说？","红豆生南国，春来发几枝。","黄鹂"],t=Math.floor(10*Math.random());return e[t]}i.d(t,{c:function(){return n}})}}]);
//# sourceMappingURL=509.4e3e07e5.js.map